<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>Agency Ops QStream Activity - With Alexa</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Tableau and Alexa">
		<meta name="author" content="Cody Knepp">

		<script src="annyang.min.js"></script> <!-- Voice Recognition -->
		<script src="responsivevoice.js"></script> <!-- Voice Response -->
		
		<script src="https://public.tableausoftware.com/javascripts/api/tableau-2.min.js " type="text/javascript"></script> 
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		    <!-- stylesheet css -->
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/font-awesome.min.css">
		<link rel="stylesheet" href="css/nivo-lightbox.css">
		<link rel="stylesheet" href="css/nivo_themes/default/default.css">
		<link rel="stylesheet" href="css/templatemo-style.css">
		<!-- google web font css -->
		<link href='http://fonts.googleapis.com/css?family=Raleway:400,300,600,700' rel='stylesheet' type='text/css'>

</head>	

<body onload=initializeViz(); data-spy="scroll" data-target=".navbar-collapse" id="top">
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
    	
        <!--Logo goes here -->
      <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon icon-bar"></span> <span class="icon icon-bar"></span> <span class="icon icon-bar"></span></button>

   </div>
      <!--End logo code -->
      
    <div class="collapse navbar-collapse">
    
      <ul class="nav navbar-nav navbar-left" >
	 <li><a href="index.html" class="smoothScroll">AGENCY OPS EDUCATION</a></li>
        <li><a href="index.html" class="smoothScroll">HOME</a></li>
        <!--<li><a href="InteractiveCourses.html" class="smoothScroll">INTERACTIVE COURSES</a></li>-->
        <li><a href="Activity.html" class="smoothScroll">ACTIVITY REPORT</a></li>
        <li><a href="AddResources.html" class="smoothScroll">COURSE SATISFACTION</a></li>
        <li><a href="AutoNewHire.html" class="smoothScroll">NATIONAL SCHOOL NPS</a></li>
      </ul>
    </div>
  </div>
</div>


<!-- divider section -->
<div class="container-fluid">
  <div class="row">
    <div class="col-md-1 col-sm-1"></div>
    <div class="col-md-10 col-sm-10">
      <hr>
    </div>
    <div class="col-md-1 col-sm-1"></div>
  </div>
</div>

<!-- divider section -->
<div class="container-fluid">
  <div class="row">
    <div class="col-md-1 col-sm-1"></div>
    <div class="col-md-10 col-sm-10">
      <hr>
    </div>
    <div class="col-md-1 col-sm-1"></div>
  </div>
</div>
<!-- service section -->
<div id="service">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-16 col-sm-16">
      <div class="col-md-3 col-sm-3"> <i class="fa fa-microphone"></i>
        <h4>&nbsp;&nbsp;Tableau Alexa Integration</h4>
        <p>Try using phrases such as "Select Northeast Region" or "Filter Month to January 2018."</p>
		<br>
			<h4>New Agency Onboarding Highlights</h4>
		<!--<button type="button" onclick="selectCalifornia()">Paremeter Change</button>-->
      </div>

      <div class="col-md-8 col-sm-8"> 
       
		<center><div id='tableauViz'></div></center>
      </div>
      
    </div>
  </div>
</div>


<script>
  // These are the voice commands in quotes followed by the function
  var commands = {
	'Alexa Open the Activity Report': function() { OpenActivity(); responsiveVoice.speak('Opening the Activity Report'); }, 
	'Alexa go to the home page': function() { OpenHome(); responsiveVoice.speak('Opening the Home Page'); }, 
	'Hi Alexa': function() { selectHello(); responsiveVoice.speak('Hello Cody'); }, 
	'How are you today': function() { selectToday(); responsiveVoice.speak('I am doing well thank you for asking'); },  
	'Alexa tell me the highlights': function() { selectOverview(); responsiveVoice.speak(''); },  
  	'Select All Regions': function() { selectAllRegions(); responsiveVoice.speak('selecting all regions'); },
	'Select California Region': function() { selectCalifornia(); responsiveVoice.speak('selecting California region'); },
	'Select Capital Region': function() { selectCapital(); responsiveVoice.speak('selecting Capital region'); },
	'Select Florida Region': function() { selectFlorida(); responsiveVoice.speak('selecting Florida region'); },
	'Select Home Office Region': function() { selectHomeOffice(); responsiveVoice.speak('selecting Home Office region'); },
	'Select Midwest Region': function() { selectMidwest(); responsiveVoice.speak('selecting Midwest region'); },
	'Select New Jersey Region': function() { selectNewJersey(); responsiveVoice.speak('selecting New Jersey region'); },
	'Select New York Region': function() { selectNewYork(); responsiveVoice.speak('selecting New York  region'); },
	'Select North Central Region': function() { selectNorthCentral(); responsiveVoice.speak('selecting North Central region'); },
	'Select Northeast Region': function() { selectNortheast(); responsiveVoice.speak('selecting Northeast region'); },
	'Select Northwest Region': function() { selectNorthwest(); responsiveVoice.speak('selecting Northwest region'); },
	'Select Southeast Region': function() { selectSoutheast(); responsiveVoice.speak('selecting Southeast region'); },
	'Select Southwest Region': function() { selectSouthwest(); responsiveVoice.speak('selecting Southwest region'); },
	'Select Southern Region': function() { selectSouthern(); responsiveVoice.speak('selecting Southern region'); },
	'Select Southwest Region': function() { selectSouthwest(); responsiveVoice.speak('selecting Southwest region'); },
	'Select Texas Region': function() { selectTexas(); responsiveVoice.speak('selecting Texas region'); },
	'Select West Central Region': function() { selectWestCentral(); responsiveVoice.speak('selecting West Central Region'); },

	//Months
	'Filter month to January 2018': function() { selectJanuary18(); responsiveVoice.speak('filtering month to January 2018'); },
	'Filter month to January 2017': function() { selectJanuary(); responsiveVoice.speak('filtering month to January 2017'); },
	'Filter month to February 2017': function() { selectFebruary(); responsiveVoice.speak('filtering month to February 2017'); },
	'Filter month to March 2017': function() { selectMarch(); responsiveVoice.speak('filtering month to March 2017'); },
	'Filter month to April 2017': function() { selectApril(); responsiveVoice.speak('filtering month to April 2017'); },
	'Filter month to May 2017': function() { selectMay(); responsiveVoice.speak('filtering month to May 2017'); },
	'Filter month to June 2017': function() { selectJune(); responsiveVoice.speak('filtering month to June 2017'); },
	'Filter month to July 2017': function() { selectJuly(); responsiveVoice.speak('filtering month to July 2017'); },
	'Filter month to August 2017': function() { selectAugust(); responsiveVoice.speak('filtering month to August 2017'); },
	'Filter month to September 2017': function() { selecSeptember(); responsiveVoice.speak('filtering month to September 2017'); },
	'Filter month to October 2017': function() { selectOctober(); responsiveVoice.speak('filtering month to October 2017'); },
	'Filter month to November 2017': function() { selectNovember(); responsiveVoice.speak('filtering month to November 2017'); },
	'Filter month to December 2017': function() { selectDecember(); responsiveVoice.speak('filtering month to December 2017'); },

	'start over': function() { startover(); responsiveVoice.speak('starting over'); }
 };
  
  // Add commands to annyang
  annyang.addCommands(commands);
  
  // Start listening.
  annyang.start();

</script>

<script>
var viz, workbook, activeSheet, Worksheet, worksheet;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "https://public.tableau.com/views/AgencyOpsEducationOverview-ALEXA/AOEPODashboard?:embed=y&:display_count=yes&publish=yes";
var options = {


   hideTabs: true,
   hideToolbar: true,


  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();

}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
}

//Tabitha says hello
responsiveVoice.speak('Welcome to the Agency Ops Tableau Alexa Integration');
selectDecember();

//Make Character selection
function selectHello()
	{

	}
function selectToday()
	{
	
	}
function OpenHome()
	{
	location.href = "Index.html";
	}
	function OpenActivity()
	{
	location.href = "Activity.html";
	}
function selectOverview ()
{
	responsiveVoice.speak('There were 63 new agents this month, and half of them are startup agencies' +
			      'Overall confidence in new agents rose from 63% to 91% after AOC' +
			     'National School satisfaction increased 25% over the prior month' +
			     'LSP confidence sits at 87% for the year and finally we had approximately 700 LSPS complete binding authority this month. ');
}

function selectAllRegions()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'All');
	}


function selectCalifornia()
{ 
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'CA');
}

function selectCapital()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'CAP');
	}
function selectFlorida()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'FL');
	}
function selectHomeOffice()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'HO');
	}
function selectMidwest()
	{
		workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'MW');
	}
function selectNewJersey()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'ANJ');
	}
function selectNewYork()
	{
		workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'NY');
	}
function selectNorthCentral()
	{
		workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'NC');
	}
function selectNortheast()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'NE');
	}
function selectNorthwest()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'NW');
	}
function selectSoutheast()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'SE');
	}
function selectSouthern()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'SO');
	}
function selectSouthwest()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'SW');
	}
function selectTexas()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'TX');
	}
function selectWestCentral()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('Region Parameter',  'WC');
	}

function selectJanuary18()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'January 2018');
	}
function selectJanuary()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'January 2017');
	}
function selectFebruary()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'February 2017');
}
function selectMarch()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('CAU Date Parameter',  'March 2017');
}
function selectApril()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'April 2017');
}
function selectMay()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'May 2017');
}
function selectJune()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'June 2017');
}
function selectJuly()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'July 2017');
	}
function selectAugust()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'August 2017');
	}
function selectSeptember()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'September 2017');
	}
function selectOctober()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'October 2017');
	}
function selectNovember()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'November 2017');
	}
function selectDecember()
	{
	workbook = viz.getWorkbook();
	workbook.changeParameterValueAsync('AU Date Parameter',  'December 2017');
	}

//Start Viz Over
function startover()
	{
		responsiveVoice.speak('Resetting the dashboard')
	viz.revertAllAsync();
	viz.refreshDataAsync();
	}

</script>

</body>
</html>		
		
		
